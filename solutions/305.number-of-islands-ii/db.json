{"python":"class Solution(object):\n    def numIslands2(self, m, n, positions):\n        def find(x):\n            if parent[x] != x:\n                return find(parent[x])\n            else:\n                return x\n\n        def union(x, y):\n            x, y = find(x), find(y)\n            if x != y:\n                if rank[x] < rank[y]:\n                    y, x = x, y\n                parent[y] = x\n                rank[x] += rank[x] == rank[y]\n                count[0] -= 1\n        \n        parent, rank = {}, {}\n        counts, count = [], [0]\n        for i, j in positions:\n            x = parent[x] = i, j\n            rank[x] = 0\n            count[0] += 1\n            for y in (i+1, j), (i-1, j), (i, j-1), (i, j+1):\n                if y in parent:\n                    union(x, y)\n            counts.append(count[0])\n            \n        return counts"}